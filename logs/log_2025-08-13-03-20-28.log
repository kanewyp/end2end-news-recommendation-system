[2025-08-13 03:20:29,483] numexpr.utils - INFO - Note: NumExpr detected 22 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
[2025-08-13 03:20:29,483] numexpr.utils - INFO - NumExpr defaulting to 8 threads.
[2025-08-13 03:20:32,103] root - INFO - ====================Data Ingestion log started.==================== 
[2025-08-13 03:20:32,104] root - INFO - Data Ingestion Config: DataIngestionConfig(dataset_download_url='https://github.com/kanewyp/end2end-news-recommendation-system/raw/main/data.zip', raw_data_dir='artifacts/dataset/raw_data', ingested_data_dir='artifacts/dataset/ingested_data')
[2025-08-13 03:20:32,104] root - INFO - Data Validation Config: DataValidationConfig(clean_data_dir='artifacts/dataset/clean_data', news_tsv_file='artifacts/dataset/ingested_data/data/news_data.tsv', behaviours_tsv_file='artifacts/dataset/ingested_data/data/behaviours_data.tsv', serialized_objects_dir='artifacts/serialized_objects')
[2025-08-13 03:20:32,104] root - INFO - Data Transformation Config: DataTransformationConfig(clean_data_file_path='artifacts/dataset/clean_data/clean_data.csv', glove_url='https://huggingface.co/stanfordnlp/glove/resolve/main/glove.6B.zip', transformed_data_dir='artifacts/dataset/transformed_data', embedding_dim=100)
[2025-08-13 03:20:32,104] root - INFO - Data Validation Config: DataValidationConfig(clean_data_dir='artifacts/dataset/clean_data', news_tsv_file='artifacts/dataset/ingested_data/data/news_data.tsv', behaviours_tsv_file='artifacts/dataset/ingested_data/data/behaviours_data.tsv', serialized_objects_dir='artifacts/serialized_objects')
[2025-08-13 03:20:32,104] root - INFO - Model Trainer Config: ModelTrainerConfig(transformed_data_file_dir='artifacts/dataset/transformed_data/embedding.npy', trained_model_dir='artifacts/dataset/trained_model', trained_model_name='model.pkl', batch_size=128, num_filters=128, filter_sizes=[3, 4, 5], user_embed_dim=50, category_embed_dim=20, dropout=0.3, learning_rate=0.001, weight_decay='1e-5', scheduler_factor=0.5, scheduler_patience=3, patience_stop_criteria=5, num_epochs=20)
[2025-08-13 03:20:32,104] root - INFO - Data Transformation Config: DataTransformationConfig(clean_data_file_path='artifacts/dataset/clean_data/clean_data.csv', glove_url='https://huggingface.co/stanfordnlp/glove/resolve/main/glove.6B.zip', transformed_data_dir='artifacts/dataset/transformed_data', embedding_dim=100)
[2025-08-13 03:20:32,104] root - INFO - Data Validation Config: DataValidationConfig(clean_data_dir='artifacts/dataset/clean_data', news_tsv_file='artifacts/dataset/ingested_data/data/news_data.tsv', behaviours_tsv_file='artifacts/dataset/ingested_data/data/behaviours_data.tsv', serialized_objects_dir='artifacts/serialized_objects')
[2025-08-13 03:20:32,104] root - INFO - Downloading data from https://github.com/kanewyp/end2end-news-recommendation-system/raw/main/data.zip into file artifacts/dataset/raw_data/data.zip
[2025-08-13 03:20:33,423] root - INFO - Downloaded data from https://github.com/kanewyp/end2end-news-recommendation-system/raw/main/data.zip into file artifacts/dataset/raw_data/data.zip
[2025-08-13 03:20:33,494] root - INFO - Extracting zip file: artifacts/dataset/raw_data/data.zip into dir: artifacts/dataset/ingested_data
[2025-08-13 03:20:33,494] root - INFO - ====================Data Ingestion log completed.==================== 


[2025-08-13 03:20:33,494] root - INFO - ====================Data Validation log started.==================== 
[2025-08-13 03:20:33,625] root - INFO -  Shape of news data file: (7281, 4)
[2025-08-13 03:20:33,626] root - INFO -  Shape of behaviours data file: (16606, 11)
[2025-08-13 03:20:33,660] root - INFO - lowercased and removed punctuation from Title and Abstract
[2025-08-13 03:20:33,760] root - INFO - removed stopwords from Title and Abstract
[2025-08-13 03:20:33,778] root - INFO - removed numbers from Title and Abstract
[2025-08-13 03:20:33,780] root - INFO - Created category mapping
[2025-08-13 03:20:33,780] root - INFO - Created subcategory mapping
[2025-08-13 03:20:33,814] root - INFO - Tokenized Title and Abstract
[2025-08-13 03:20:34,151] root - INFO - Created word dictionary with 23761 unique words
[2025-08-13 03:20:34,169] root - INFO - Created user id to index mapping with 1001 unique users
[2025-08-13 03:20:34,184] root - INFO - Saved serialized objects to artifacts/serialized_objects
[2025-08-13 03:20:34,184] root - INFO - Utils state: {'vert_num': 16, 'subvert_num': 190, 'word_num': 23761, 'uid2index': 1001}
[2025-08-13 03:20:34,373] root - INFO - Saved cleaned data to artifacts/dataset/clean_data
[2025-08-13 03:20:34,385] root - INFO - ====================Data Validation log completed.==================== 


[2025-08-13 03:20:34,385] root - INFO - ====================Data Transformation log started.==================== 
[2025-08-13 03:20:34,389] root - INFO - Temporary directory created at: /tmp/tmpsgynyy8k
[2025-08-13 03:20:34,390] root - INFO - Downloading GloVe embeddings from Hugging Face...
[2025-08-13 03:20:34,392] urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
[2025-08-13 03:20:34,790] urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /stanfordnlp/glove/resolve/main/glove.6B.zip HTTP/11" 302 1024
[2025-08-13 03:20:34,794] urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): cdn-lfs.hf.co:443
[2025-08-13 03:20:34,865] urllib3.connectionpool - DEBUG - https://cdn-lfs.hf.co:443 "GET /stanfordnlp/glove/6471382cdd837544bf3ac72497a38715e845897d265b2b424b4761832009c837?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27glove.6B.zip%3B+filename%3D%22glove.6B.zip%22%3B&response-content-type=application%2Fzip&Expires=1755015635&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc1NTAxNTYzNX19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy5oZi5jby9zdGFuZm9yZG5scC9nbG92ZS82NDcxMzgyY2RkODM3NTQ0YmYzYWM3MjQ5N2EzODcxNWU4NDU4OTdkMjY1YjJiNDI0YjQ3NjE4MzIwMDljODM3P3Jlc3BvbnNlLWNvbnRlbnQtZGlzcG9zaXRpb249KiZyZXNwb25zZS1jb250ZW50LXR5cGU9KiJ9XX0_&Signature=L5Qb5doSCx-U2cpANNzwr5SX84VPdppKxxvo1KspBXQfLSLNAnxquaXCg0e9HBMia4aKmxZcNQ0EJn389mVuKA75HVvQN0gswrgj-fhJnU6RnXMABJpkQlkF~2CMGtDQDl7W8HHm-GrxUvo2vkBK1MCEnbCI1So0SyxtgWzZfqavy97q2B0qFSE8wBpWmAs3zzyzcMeajjVK0r2VfANkUC4N1xxPbx~FGh7izq2zSlarh66Dhd-dlCdFFQgM7PHtAvpILxnJN8Z9IieuDp2gZHvygXjRVqKof-UhGtf-ugNwrFRD-SksKDsgWpJagU8ufUKZ-n3IAZu6~r7YIvtqyQ__&Key-Pair-Id=K3RPWS32NSSJCE HTTP/11" 200 862182753
[2025-08-13 03:20:52,164] root - INFO - Download complete.
[2025-08-13 03:20:52,164] root - INFO - Extracting GloVe embeddings...
[2025-08-13 03:21:05,257] root - INFO - Extraction complete.
[2025-08-13 03:21:05,262] root - INFO - Word dictionary loaded with 23761 words.
[2025-08-13 03:21:06,811] root - INFO - Embedding matrix created
[2025-08-13 03:21:06,811] root - INFO - Embedding matrix dimensions: 23762 x 100
[2025-08-13 03:21:06,821] root - INFO - Saved embedding matrix to artifacts/dataset/transformed_data
[2025-08-13 03:21:06,821] root - INFO - Temporary directory /tmp/tmpsgynyy8k cleaned up.
[2025-08-13 03:21:07,001] root - INFO - ====================Data Transformation log completed.==================== 


[2025-08-13 03:21:07,001] root - INFO - ====================Model Trainer log started.==================== 
[2025-08-13 03:21:07,009] root - INFO - Serialized objects loaded successfully.
