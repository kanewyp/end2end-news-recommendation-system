[2025-08-13 04:59:30,686] numexpr.utils - INFO - Note: NumExpr detected 22 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
[2025-08-13 04:59:30,687] numexpr.utils - INFO - NumExpr defaulting to 8 threads.
[2025-08-13 04:59:33,549] root - INFO - Model Trainer Config: ModelTrainerConfig(transformed_data_file_dir='artifacts/dataset/transformed_data/embedding.npy', trained_model_dir='artifacts/dataset/trained_model', trained_model_name='model.pkl', batch_size=128, num_filters=128, filter_sizes=[3, 4, 5], user_embed_dim=50, category_embed_dim=20, dropout=0.3, learning_rate=0.001, weight_decay='1e-5', scheduler_factor=0.5, scheduler_patience=3, patience_stop_criteria=5, num_epochs=20)
[2025-08-13 04:59:33,550] root - INFO - Data Transformation Config: DataTransformationConfig(clean_data_file_path='artifacts/dataset/clean_data/clean_data.csv', glove_url='https://huggingface.co/stanfordnlp/glove/resolve/main/glove.6B.zip', transformed_data_dir='artifacts/dataset/transformed_data', embedding_dim=100)
[2025-08-13 04:59:33,550] root - INFO - Data Validation Config: DataValidationConfig(clean_data_dir='artifacts/dataset/clean_data', news_tsv_file='artifacts/dataset/ingested_data/data/news_data.tsv', behaviours_tsv_file='artifacts/dataset/ingested_data/data/behaviours_data.tsv', serialized_objects_dir='artifacts/serialized_objects')
[2025-08-13 04:59:33,550] root - INFO - ====================Model Trainer log started.==================== 
[2025-08-13 04:59:33,554] root - INFO - Serialized objects loaded successfully.
[2025-08-13 04:59:33,567] root - INFO - Embedding matrix loaded successfully.
[2025-08-13 04:59:33,567] root - INFO - Vocabulary size: 23761
[2025-08-13 04:59:33,567] root - INFO - Embedding matrix shape: (23762, 100)
[2025-08-13 04:59:33,567] root - INFO - Number of users: 1001
[2025-08-13 04:59:33,567] root - INFO - Number of categories: 16
[2025-08-13 04:59:33,567] root - INFO - Number of subcategories: 190
[2025-08-13 04:59:33,567] root - INFO - 3.8.20 (default, Oct  3 2024, 15:24:27) 
[GCC 11.2.0]
[2025-08-13 04:59:33,567] root - INFO - Using device: cpu
[2025-08-13 04:59:33,672] root - INFO - News and Behaviours data loaded successfully.
[2025-08-13 04:59:34,292] root - INFO - News data converted successfully.
[2025-08-13 04:59:34,292] root - INFO - Preparing training data...
[2025-08-13 04:59:49,357] root - INFO - Total training samples: 53979
[2025-08-13 04:59:49,380] root - INFO - Training samples: 43183, Validation samples: 10796
[2025-08-13 04:59:49,382] root - INFO - Datasets created successfully.
[2025-08-13 04:59:49,382] root - INFO - DataLoaders created successfully.
[2025-08-13 04:59:49,526] root - INFO - Model initialized successfully.
[2025-08-13 04:59:49,526] root - INFO - Training components initialized successfully.
[2025-08-13 04:59:49,526] root - INFO - Starting training...
[2025-08-13 04:59:49,526] root - INFO - Training for 20 epochs
[2025-08-13 04:59:49,526] root - INFO - ------------------------------------------------------------
[2025-08-13 04:59:49,531] root - INFO - Epoch 1/20
[2025-08-13 05:00:16,577] root - INFO - Train Loss: 0.6913, Train AUC: 0.5347, Train Acc: 0.5224
[2025-08-13 05:00:16,577] root - INFO - Val Loss: 0.6858, Val AUC: 0.5865, Val Acc: 0.5408
[2025-08-13 05:00:16,577] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:00:16,577] root - INFO - New best model! AUC: 0.5865
[2025-08-13 05:00:16,577] root - INFO - ------------------------------------------------------------
[2025-08-13 05:00:16,577] root - INFO - Epoch 2/20
[2025-08-13 05:00:43,134] root - INFO - Train Loss: 0.6799, Train AUC: 0.5909, Train Acc: 0.5656
[2025-08-13 05:00:43,134] root - INFO - Val Loss: 0.6779, Val AUC: 0.6019, Val Acc: 0.5665
[2025-08-13 05:00:43,134] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:00:43,134] root - INFO - New best model! AUC: 0.6019
[2025-08-13 05:00:43,135] root - INFO - ------------------------------------------------------------
[2025-08-13 05:00:43,135] root - INFO - Epoch 3/20
[2025-08-13 05:01:06,372] root - INFO - Train Loss: 0.6746, Train AUC: 0.6090, Train Acc: 0.5779
[2025-08-13 05:01:06,373] root - INFO - Val Loss: 0.6747, Val AUC: 0.6115, Val Acc: 0.5803
[2025-08-13 05:01:06,373] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:01:06,373] root - INFO - New best model! AUC: 0.6115
[2025-08-13 05:01:06,373] root - INFO - ------------------------------------------------------------
[2025-08-13 05:01:06,373] root - INFO - Epoch 4/20
[2025-08-13 05:01:33,888] root - INFO - Train Loss: 0.6702, Train AUC: 0.6212, Train Acc: 0.5898
[2025-08-13 05:01:33,889] root - INFO - Val Loss: 0.6702, Val AUC: 0.6197, Val Acc: 0.5887
[2025-08-13 05:01:33,889] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:01:33,889] root - INFO - New best model! AUC: 0.6197
[2025-08-13 05:01:33,889] root - INFO - ------------------------------------------------------------
[2025-08-13 05:01:33,889] root - INFO - Epoch 5/20
[2025-08-13 05:02:08,159] root - INFO - Train Loss: 0.6660, Train AUC: 0.6317, Train Acc: 0.5954
[2025-08-13 05:02:08,159] root - INFO - Val Loss: 0.6679, Val AUC: 0.6262, Val Acc: 0.5854
[2025-08-13 05:02:08,159] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:02:08,159] root - INFO - New best model! AUC: 0.6262
[2025-08-13 05:02:08,159] root - INFO - ------------------------------------------------------------
[2025-08-13 05:02:08,159] root - INFO - Epoch 6/20
[2025-08-13 05:02:44,188] root - INFO - Train Loss: 0.6621, Train AUC: 0.6400, Train Acc: 0.6019
[2025-08-13 05:02:44,188] root - INFO - Val Loss: 0.6673, Val AUC: 0.6297, Val Acc: 0.5879
[2025-08-13 05:02:44,188] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:02:44,189] root - INFO - New best model! AUC: 0.6297
[2025-08-13 05:02:44,189] root - INFO - ------------------------------------------------------------
[2025-08-13 05:02:44,189] root - INFO - Epoch 7/20
[2025-08-13 05:03:21,758] root - INFO - Train Loss: 0.6600, Train AUC: 0.6446, Train Acc: 0.6043
[2025-08-13 05:03:21,758] root - INFO - Val Loss: 0.6651, Val AUC: 0.6314, Val Acc: 0.5925
[2025-08-13 05:03:21,758] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:03:21,758] root - INFO - New best model! AUC: 0.6314
[2025-08-13 05:03:21,759] root - INFO - ------------------------------------------------------------
[2025-08-13 05:03:21,759] root - INFO - Epoch 8/20
[2025-08-13 05:04:00,051] root - INFO - Train Loss: 0.6568, Train AUC: 0.6497, Train Acc: 0.6071
[2025-08-13 05:04:00,051] root - INFO - Val Loss: 0.6635, Val AUC: 0.6337, Val Acc: 0.5954
[2025-08-13 05:04:00,051] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:04:00,052] root - INFO - New best model! AUC: 0.6337
[2025-08-13 05:04:00,052] root - INFO - ------------------------------------------------------------
[2025-08-13 05:04:00,052] root - INFO - Epoch 9/20
[2025-08-13 05:04:39,288] root - INFO - Train Loss: 0.6532, Train AUC: 0.6561, Train Acc: 0.6089
[2025-08-13 05:04:39,288] root - INFO - Val Loss: 0.6663, Val AUC: 0.6306, Val Acc: 0.5902
[2025-08-13 05:04:39,288] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:04:39,288] root - INFO - ------------------------------------------------------------
[2025-08-13 05:04:39,288] root - INFO - Epoch 10/20
[2025-08-13 05:05:23,879] root - INFO - Train Loss: 0.6495, Train AUC: 0.6608, Train Acc: 0.6097
[2025-08-13 05:05:23,880] root - INFO - Val Loss: 0.6657, Val AUC: 0.6333, Val Acc: 0.5921
[2025-08-13 05:05:23,880] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:05:23,880] root - INFO - ------------------------------------------------------------
[2025-08-13 05:05:23,880] root - INFO - Epoch 11/20
[2025-08-13 05:06:09,250] root - INFO - Train Loss: 0.6462, Train AUC: 0.6669, Train Acc: 0.6162
[2025-08-13 05:06:09,251] root - INFO - Val Loss: 0.6640, Val AUC: 0.6351, Val Acc: 0.5987
[2025-08-13 05:06:09,251] root - INFO - Learning Rate: 0.001000
[2025-08-13 05:06:09,251] root - INFO - New best model! AUC: 0.6351
[2025-08-13 05:06:09,251] root - INFO - ------------------------------------------------------------
[2025-08-13 05:06:09,252] root - INFO - Epoch 12/20
[2025-08-13 05:06:56,609] root - INFO - Train Loss: 0.6411, Train AUC: 0.6742, Train Acc: 0.6202
[2025-08-13 05:06:56,610] root - INFO - Val Loss: 0.6648, Val AUC: 0.6378, Val Acc: 0.5967
[2025-08-13 05:06:56,610] root - INFO - Learning Rate: 0.000500
[2025-08-13 05:06:56,610] root - INFO - New best model! AUC: 0.6378
[2025-08-13 05:06:56,610] root - INFO - ------------------------------------------------------------
[2025-08-13 05:06:56,610] root - INFO - Epoch 13/20
[2025-08-13 05:07:48,207] root - INFO - Train Loss: 0.6301, Train AUC: 0.6919, Train Acc: 0.6343
[2025-08-13 05:07:48,207] root - INFO - Val Loss: 0.6679, Val AUC: 0.6364, Val Acc: 0.5983
[2025-08-13 05:07:48,207] root - INFO - Learning Rate: 0.000500
[2025-08-13 05:07:48,207] root - INFO - ------------------------------------------------------------
[2025-08-13 05:07:48,207] root - INFO - Epoch 14/20
[2025-08-13 05:08:38,040] root - INFO - Train Loss: 0.6247, Train AUC: 0.7013, Train Acc: 0.6402
[2025-08-13 05:08:38,040] root - INFO - Val Loss: 0.6700, Val AUC: 0.6382, Val Acc: 0.5972
[2025-08-13 05:08:38,040] root - INFO - Learning Rate: 0.000500
[2025-08-13 05:08:38,041] root - INFO - New best model! AUC: 0.6382
[2025-08-13 05:08:38,041] root - INFO - ------------------------------------------------------------
[2025-08-13 05:08:38,041] root - INFO - Epoch 15/20
[2025-08-13 05:09:30,214] root - INFO - Train Loss: 0.6204, Train AUC: 0.7069, Train Acc: 0.6437
[2025-08-13 05:09:30,214] root - INFO - Val Loss: 0.6739, Val AUC: 0.6382, Val Acc: 0.5998
[2025-08-13 05:09:30,214] root - INFO - Learning Rate: 0.000500
[2025-08-13 05:09:30,214] root - INFO - New best model! AUC: 0.6382
[2025-08-13 05:09:30,214] root - INFO - ------------------------------------------------------------
[2025-08-13 05:09:30,215] root - INFO - Epoch 16/20
[2025-08-13 05:10:20,410] root - INFO - Train Loss: 0.6149, Train AUC: 0.7154, Train Acc: 0.6519
[2025-08-13 05:10:20,410] root - INFO - Val Loss: 0.6739, Val AUC: 0.6388, Val Acc: 0.5970
[2025-08-13 05:10:20,410] root - INFO - Learning Rate: 0.000250
[2025-08-13 05:10:20,410] root - INFO - New best model! AUC: 0.6388
[2025-08-13 05:10:20,410] root - INFO - ------------------------------------------------------------
[2025-08-13 05:10:20,411] root - INFO - Epoch 17/20
[2025-08-13 05:11:14,082] root - INFO - Train Loss: 0.6046, Train AUC: 0.7290, Train Acc: 0.6624
[2025-08-13 05:11:14,083] root - INFO - Val Loss: 0.6740, Val AUC: 0.6387, Val Acc: 0.6018
[2025-08-13 05:11:14,083] root - INFO - Learning Rate: 0.000250
[2025-08-13 05:11:14,083] root - INFO - ------------------------------------------------------------
[2025-08-13 05:11:14,083] root - INFO - Epoch 18/20
[2025-08-13 05:12:09,372] root - INFO - Train Loss: 0.6024, Train AUC: 0.7322, Train Acc: 0.6643
[2025-08-13 05:12:09,373] root - INFO - Val Loss: 0.6767, Val AUC: 0.6404, Val Acc: 0.6021
[2025-08-13 05:12:09,373] root - INFO - Learning Rate: 0.000250
[2025-08-13 05:12:09,373] root - INFO - New best model! AUC: 0.6404
[2025-08-13 05:12:09,373] root - INFO - ------------------------------------------------------------
[2025-08-13 05:12:09,374] root - INFO - Epoch 19/20
[2025-08-13 05:13:11,171] root - INFO - Train Loss: 0.6006, Train AUC: 0.7350, Train Acc: 0.6660
[2025-08-13 05:13:11,171] root - INFO - Val Loss: 0.6803, Val AUC: 0.6368, Val Acc: 0.5958
[2025-08-13 05:13:11,171] root - INFO - Learning Rate: 0.000250
[2025-08-13 05:13:11,171] root - INFO - ------------------------------------------------------------
[2025-08-13 05:13:11,171] root - INFO - Epoch 20/20
[2025-08-13 05:14:20,115] root - INFO - Train Loss: 0.5975, Train AUC: 0.7394, Train Acc: 0.6720
[2025-08-13 05:14:20,115] root - INFO - Val Loss: 0.6816, Val AUC: 0.6364, Val Acc: 0.5980
[2025-08-13 05:14:20,115] root - INFO - Learning Rate: 0.000125
[2025-08-13 05:14:20,115] root - INFO - ------------------------------------------------------------
