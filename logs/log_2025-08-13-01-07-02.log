[2025-08-13 01:07:02,831] numexpr.utils - INFO - Note: NumExpr detected 22 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
[2025-08-13 01:07:02,831] numexpr.utils - INFO - NumExpr defaulting to 8 threads.
[2025-08-13 01:07:03,101] root - INFO - ====================Data Ingestion log started.==================== 
[2025-08-13 01:07:03,101] root - INFO - Data Ingestion Config: DataIngestionConfig(dataset_download_url='https://github.com/kanewyp/end2end-news-recommendation-system/raw/main/data.zip', raw_data_dir='artifacts/dataset/raw_data', ingested_data_dir='artifacts/dataset/ingested_data')
[2025-08-13 01:07:03,101] root - INFO - Data Validation Config: DataValidationConfig(clean_data_dir='artifacts/dataset/clean_data', news_tsv_file='artifacts/dataset/ingested_data/data/news_data.tsv', behaviours_tsv_file='artifacts/dataset/ingested_data/data/behaviours_data.tsv', serialized_objects_dir='artifacts/serialized_objects')
[2025-08-13 01:07:03,101] root - INFO - Data Transformation Config: DataTransformationConfig(clean_data_file_path='artifacts/dataset/clean_data/clean_data.csv', glove_url='https://huggingface.co/stanfordnlp/glove/resolve/main/glove.6B.zip', transformed_data_dir='artifacts/dataset/transformed_data', embedding_dim=100)
[2025-08-13 01:07:03,101] root - INFO - Data Validation Config: DataValidationConfig(clean_data_dir='artifacts/dataset/clean_data', news_tsv_file='artifacts/dataset/ingested_data/data/news_data.tsv', behaviours_tsv_file='artifacts/dataset/ingested_data/data/behaviours_data.tsv', serialized_objects_dir='artifacts/serialized_objects')
[2025-08-13 01:07:03,101] root - INFO - Downloading data from https://github.com/kanewyp/end2end-news-recommendation-system/raw/main/data.zip into file artifacts/dataset/raw_data/data.zip
[2025-08-13 01:07:04,256] root - INFO - Downloaded data from https://github.com/kanewyp/end2end-news-recommendation-system/raw/main/data.zip into file artifacts/dataset/raw_data/data.zip
[2025-08-13 01:07:04,324] root - INFO - Extracting zip file: artifacts/dataset/raw_data/data.zip into dir: artifacts/dataset/ingested_data
[2025-08-13 01:07:04,324] root - INFO - ====================Data Ingestion log completed.==================== 


[2025-08-13 01:07:04,324] root - INFO - ====================Data Validation log started.==================== 
[2025-08-13 01:07:04,437] root - INFO -  Shape of news data file: (7281, 4)
[2025-08-13 01:07:04,437] root - INFO -  Shape of behaviours data file: (16606, 11)
[2025-08-13 01:07:04,462] root - INFO - lowercased and removed punctuation from Title and Abstract
[2025-08-13 01:07:04,529] root - INFO - removed stopwords from Title and Abstract
[2025-08-13 01:07:04,543] root - INFO - removed numbers from Title and Abstract
[2025-08-13 01:07:04,544] root - INFO - Created category mapping
[2025-08-13 01:07:04,544] root - INFO - Created subcategory mapping
[2025-08-13 01:07:04,578] root - INFO - Tokenized Title and Abstract
[2025-08-13 01:07:04,879] root - INFO - Created word dictionary with 23761 unique words
[2025-08-13 01:07:04,896] root - INFO - Created user id to index mapping with 1001 unique users
[2025-08-13 01:07:04,900] root - INFO - Saved serialized objects to artifacts/serialized_objects
[2025-08-13 01:07:04,900] root - INFO - Utils state: {'vert_num': 16, 'subvert_num': 190, 'word_num': 23761, 'uid2index': 1001}
[2025-08-13 01:07:05,063] root - INFO - Saved cleaned data to artifacts/dataset/clean_data
[2025-08-13 01:07:05,068] root - INFO - ====================Data Validation log completed.==================== 


[2025-08-13 01:07:05,068] root - INFO - ====================Data Transformation log started.==================== 
[2025-08-13 01:07:05,070] root - INFO - Temporary directory created at: /tmp/tmppabibead
[2025-08-13 01:07:05,070] root - INFO - Downloading GloVe embeddings from Hugging Face...
[2025-08-13 01:07:05,073] urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
[2025-08-13 01:07:05,468] urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /stanfordnlp/glove/resolve/main/glove.6B.zip HTTP/11" 302 1026
[2025-08-13 01:07:05,469] urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): cdn-lfs.hf.co:443
[2025-08-13 01:07:05,535] urllib3.connectionpool - DEBUG - https://cdn-lfs.hf.co:443 "GET /stanfordnlp/glove/6471382cdd837544bf3ac72497a38715e845897d265b2b424b4761832009c837?response-content-disposition=inline%3B+filename*%3DUTF-8%27%27glove.6B.zip%3B+filename%3D%22glove.6B.zip%22%3B&response-content-type=application%2Fzip&Expires=1755007627&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc1NTAwNzYyN319LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2RuLWxmcy5oZi5jby9zdGFuZm9yZG5scC9nbG92ZS82NDcxMzgyY2RkODM3NTQ0YmYzYWM3MjQ5N2EzODcxNWU4NDU4OTdkMjY1YjJiNDI0YjQ3NjE4MzIwMDljODM3P3Jlc3BvbnNlLWNvbnRlbnQtZGlzcG9zaXRpb249KiZyZXNwb25zZS1jb250ZW50LXR5cGU9KiJ9XX0_&Signature=TdainHJOFHnSIwuSfeZSDc41ErNqetgF2waHn9Wb9j~sPrJZ0pY4Z~9Jc294JKMfrA0zUpFyDQdfhpB0Q6bXG5SZcJdzzohKbLhbYMVpWaMPJb4UB22ga4dxJVm8QwTz7PX8fr2TDk76lP9k1-4T4rEBmgz26zvt39HcIYHUfTUd9-iPolziRJ0KinS3dVIn-7mmnbIxpkPvjRO9xBPMgBv9-Cxx4xH8T8IyMCL4Kq7hQ9X0qnNfLCULPzN3ohZipdwIlwwniT8~-vqXaozTaCjyn3VuWF4MpiBwrR49btIcn2oqAy24v9JvNL0ERi3gewxbnv4~Emt0pFE7YR2vKQ__&Key-Pair-Id=K3RPWS32NSSJCE HTTP/11" 200 862182753
[2025-08-13 01:07:30,162] root - INFO - Download complete.
[2025-08-13 01:07:30,162] root - INFO - Extracting GloVe embeddings...
[2025-08-13 01:07:39,569] root - INFO - Extraction complete.
[2025-08-13 01:07:39,585] root - INFO - Word dictionary loaded with 23761 words.
[2025-08-13 01:07:40,877] root - INFO - Embedding matrix created
[2025-08-13 01:07:40,877] root - INFO - Embedding matrix dimensions: 23762 x 100
[2025-08-13 01:07:40,887] root - INFO - Saved embedding matrix to artifacts/dataset/transformed_data
[2025-08-13 01:07:40,888] root - INFO - Temporary directory /tmp/tmppabibead cleaned up.
[2025-08-13 01:07:41,110] root - INFO - ====================Data Transformation log completed.==================== 


